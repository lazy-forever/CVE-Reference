# CVE-2024-45945

## Vulnerability Analysis

The vulnerability is located at `com.j2eefast.framework.sys.controller.SysLicenseController#download`.

![](./assets/1.png)

At line 293, the incoming `path` is used for file reading.

![](./assets/2.png)

At line 310, the `path` file is deleted, allowing an attacker with backend access to perform arbitrary file reading and deletion.

## Vulnerability Reproduction

By passing a hex-encoded `path` and the specified `checkcode` `4c6287` to the `/fast/sys/license/download` path, file reading and deletion can be achieved. The `checkcode` is generated using `SoftEncryption.encryptBySM4(send, ConfigConstant.FAST_MAC_KEY).getStr("hex").substring(0, 6)`.

![](./assets/3.png)

